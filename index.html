<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Weixinapi : 专门用于微信公众平台的Javascript API - forked from zxlie/WeixinApi">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Weixinapi</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/itime/WeixinApi">View on GitHub</a>

          <h1 id="project_title">Weixinapi</h1>
          <h2 id="project_tagline">专门用于微信公众平台的Javascript API - forked from zxlie/WeixinApi</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/itime/WeixinApi/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/itime/WeixinApi/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="微信公众平台js-apiweixinapi" class="anchor" href="#%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%B9%B3%E5%8F%B0js-apiweixinapi" aria-hidden="true"><span class="octicon octicon-link"></span></a>微信公众平台Js API（WeixinApi）</h1>

<h2>
<a id="关于weixinapi" class="anchor" href="#%E5%85%B3%E4%BA%8Eweixinapi" aria-hidden="true"><span class="octicon octicon-link"></span></a>关于WeixinApi</h2>

<h3>
<a id="1weixinapi为何诞生" class="anchor" href="#1weixinapi%E4%B8%BA%E4%BD%95%E8%AF%9E%E7%94%9F" aria-hidden="true"><span class="octicon octicon-link"></span></a>1、WeixinApi为何诞生</h3>

<p>以前顺便玩儿了下微信公众账号，做Web前端开发的，都对页面脚本充满好奇，所以研究了下，放到<a href="http://www.baidufe.com"><code>Blog</code></a>上，
也正因为微信官方一直没有放出正式的Api提供给用户来用，所以大量的用户到我blog上去询问<code>WeixinJSBridge</code>相关的技术点，索性我就整理了一下，
起个名字叫<code>WeixinApi</code>开源到github来，提供给大家使用！</p>

<h3>
<a id="2免责声明" class="anchor" href="#2%E5%85%8D%E8%B4%A3%E5%A3%B0%E6%98%8E" aria-hidden="true"><span class="octicon octicon-link"></span></a>2、免责声明</h3>

<p>此Api为<code>非官方</code>版，由于官方的限制，继续使用此Api还有可能会出现一些意向不到的问题，一切后果请自行承担！</p>

<h3>
<a id="3weixinapi可能停止更新" class="anchor" href="#3weixinapi%E5%8F%AF%E8%83%BD%E5%81%9C%E6%AD%A2%E6%9B%B4%E6%96%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>3、WeixinApi可能停止更新</h3>

<p>目前官方已经出了正式版本的SDK，详情可见<a href="http://mp.weixin.qq.com/wiki/7/aaa137b55fb2e0456bf8dd9148dd613f.html">微信JS-SDK说明文档</a>,
所以大家还是尽早迁移到官方版本吧，这对大家来说是好事，以后出什么问题，官方渠道应该都会第一时间给出解决方案，稳定很多，也不至于经常被黑！
本API可能以后就不会频繁更新了，各位知晓！</p>

<h2>
<a id="目录" class="anchor" href="#%E7%9B%AE%E5%BD%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>目录</h2>

<ul>
<li><a href="#user-content-%E5%BF%AB%E9%80%9F%E4%BD%BF%E7%94%A8">快速使用</a></li>
<li>
<a href="#user-content-%E8%AF%A6%E7%BB%86api%E5%88%97%E8%A1%A8">详细Api列表</a>

<ul>
<li><a href="#user-content-1%E5%88%9D%E5%A7%8B%E5%8C%96%E7%AD%89%E5%BE%85%E5%88%86%E4%BA%AB">1、初始化等待分享</a></li>
<li><a href="#user-content-2%E9%9A%90%E8%97%8F%E5%8F%B3%E4%B8%8A%E8%A7%92option-menu%E5%85%A5%E5%8F%A3">2、隐藏右上角option menu入口</a></li>
<li><a href="#user-content-3%E9%9A%90%E8%97%8F%E5%BA%95%E9%83%A8%E5%B7%A5%E5%85%B7%E6%A0%8F">3、隐藏底部工具栏</a></li>
<li><a href="#user-content-4%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9A%84%E7%BD%91%E7%BB%9C%E7%B1%BB%E5%9E%8B">4、获取当前的网络类型</a></li>
<li><a href="#user-content-5%E8%B0%83%E8%B5%B7%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%9B%BE%E7%89%87%E6%92%AD%E6%94%BE%E7%BB%84%E4%BB%B6">5、调起客户端图片播放组件</a></li>
<li><a href="#user-content-6%E5%85%B3%E6%8E%89%E5%BD%93%E5%89%8D%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E9%A1%B5%E9%9D%A2%E7%AA%97%E5%8F%A3">6、关掉当前微信公众页面窗口</a></li>
<li><a href="#user-content-7%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E7%BD%91%E9%A1%B5%E6%98%AF%E5%90%A6%E5%9C%A8%E5%BE%AE%E4%BF%A1%E5%86%85%E7%BD%AE%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E6%89%93%E5%BC%80">7、判断当前网页是否在微信内置浏览器中打开</a></li>
<li><a href="#user-content-8%E5%BC%80%E5%90%AFweixinapi%E7%9A%84%E9%94%99%E8%AF%AF%E7%9B%91%E6%8E%A7">8、开启WeixinApi的错误监控</a></li>
<li><a href="#user-content-9%E5%8F%91%E9%80%81%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6">9、发送电子邮件</a></li>
<li><a href="#user-content-10%E7%A6%81%E6%AD%A2%E7%94%A8%E6%88%B7%E5%88%86%E4%BA%AB">10、禁止用户分享</a></li>
</ul>
</li>
<li><a href="#user-content-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98">常见问题</a></li>
<li><a href="#user-content-%E5%85%B6%E4%BB%96">其他</a></li>
</ul>

<p>你可以用微信的“扫一扫”来打开下面这个二维码体验一下：</p>

<p><img src="http://www.baidufe.com/upload/images/2014-06-14_3.47.02.png" alt="Weixin Api Demo"></p>

<h2>
<a id="快速使用" class="anchor" href="#%E5%BF%AB%E9%80%9F%E4%BD%BF%E7%94%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>快速使用</h2>

<div class="highlight highlight-javascript"><pre><span class="pl-c">// 定义微信分享的数据</span>
<span class="pl-s">var</span> wxData <span class="pl-k">=</span> {
    <span class="pl-s1"><span class="pl-pds">"</span>appId<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>, <span class="pl-c">// 服务号可以填写appId</span>
    <span class="pl-s1"><span class="pl-pds">"</span>imgUrl<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>http://photocdn.sohu.com/20130122/Img364302298.jpg<span class="pl-pds">'</span></span>,
    <span class="pl-s1"><span class="pl-pds">"</span>link<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>http://www.baidufe.com<span class="pl-pds">'</span></span>,
    <span class="pl-s1"><span class="pl-pds">"</span>desc<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>使用警告：此Api非官方版本，请各位尽量将分享功能迁移至腾讯官方版，会更稳定些！<span class="pl-pds">'</span></span>,
    <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">"</span>欢迎使用WeixinApi<span class="pl-pds">"</span></span>
};

<span class="pl-c">// 分享的回调</span>
<span class="pl-s">var</span> wxCallbacks <span class="pl-k">=</span> {
    <span class="pl-c">// 收藏操作是否触发回调，默认是开启的</span>
    favorite <span class="pl-k">:</span> <span class="pl-c1">false</span>,

    <span class="pl-c">// 分享操作开始之前</span>
    <span class="pl-en">ready</span> : <span class="pl-st">function</span>() {
        <span class="pl-c">// 你可以在这里对分享的数据进行重组</span>
        <span class="pl-s3">alert</span>(<span class="pl-s1"><span class="pl-pds">"</span>准备分享<span class="pl-pds">"</span></span>);
    },
    <span class="pl-c">// 分享被用户自动取消</span>
    <span class="pl-en">cancel</span> : <span class="pl-st">function</span>(<span class="pl-vpf">resp</span>) {
        <span class="pl-c">// 你可以在你的页面上给用户一个小Tip，为什么要取消呢？</span>
        <span class="pl-s3">alert</span>(<span class="pl-s1"><span class="pl-pds">"</span>分享被取消，msg=<span class="pl-pds">"</span></span> <span class="pl-k">+</span> resp.err_msg);
    },
    <span class="pl-c">// 分享失败了</span>
    <span class="pl-en">fail</span> : <span class="pl-st">function</span>(<span class="pl-vpf">resp</span>) {
        <span class="pl-c">// 分享失败了，是不是可以告诉用户：不要紧，可能是网络问题，一会儿再试试？</span>
        <span class="pl-s3">alert</span>(<span class="pl-s1"><span class="pl-pds">"</span>分享失败，msg=<span class="pl-pds">"</span></span> <span class="pl-k">+</span> resp.err_msg);
    },
    <span class="pl-c">// 分享成功</span>
    <span class="pl-en">confirm</span> : <span class="pl-st">function</span>(<span class="pl-vpf">resp</span>) {
        <span class="pl-c">// 分享成功了，我们是不是可以做一些分享统计呢？</span>
        <span class="pl-s3">alert</span>(<span class="pl-s1"><span class="pl-pds">"</span>分享成功，msg=<span class="pl-pds">"</span></span> <span class="pl-k">+</span> resp.err_msg);
    },
    <span class="pl-c">// 整个分享过程结束</span>
    <span class="pl-en">all</span> : <span class="pl-st">function</span>(<span class="pl-vpf">resp</span>,<span class="pl-vpf">shareTo</span>) {
        <span class="pl-c">// 如果你做的是一个鼓励用户进行分享的产品，在这里是不是可以给用户一些反馈了？</span>
        <span class="pl-s3">alert</span>(<span class="pl-s1"><span class="pl-pds">"</span>分享<span class="pl-pds">"</span></span> <span class="pl-k">+</span> (shareTo <span class="pl-k">?</span> <span class="pl-s1"><span class="pl-pds">"</span>到<span class="pl-pds">"</span></span> <span class="pl-k">+</span> shareTo <span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>) <span class="pl-k">+</span> <span class="pl-s1"><span class="pl-pds">"</span>结束，msg=<span class="pl-pds">"</span></span> <span class="pl-k">+</span> resp.err_msg);
    }
};
<span class="pl-c">// 自定义分享到：微信好友、朋友圈、腾讯微博、QQ好友</span>
WeixinApi.share(wxData,wxCallbacks);</pre></div>

<p>可下载源码，部署sample/sample-new.html进行测试</p>

<h2>
<a id="详细api列表" class="anchor" href="#%E8%AF%A6%E7%BB%86api%E5%88%97%E8%A1%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>详细Api列表</h2>

<p>使用起来比较简单，具体可参考sample/sample-normal.html中的实现</p>

<h3>
<a id="1初始化等待分享" class="anchor" href="#1%E5%88%9D%E5%A7%8B%E5%8C%96%E7%AD%89%E5%BE%85%E5%88%86%E4%BA%AB" aria-hidden="true"><span class="octicon octicon-link"></span></a>1、初始化等待分享</h3>

<div class="highlight highlight-javascript"><pre><span class="pl-c">// 开发阶段，开启WeixinApi的调试模式</span>
WeixinApi.enableDebugMode();

<span class="pl-c">// 初始化WeixinApi，等待分享</span>
WeixinApi.ready(<span class="pl-st">function</span>(<span class="pl-vpf">Api</span>) {

    <span class="pl-c">// 微信分享的数据</span>
    <span class="pl-s">var</span> wxData <span class="pl-k">=</span> {
        <span class="pl-s1"><span class="pl-pds">"</span>appId<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>, <span class="pl-c">// 服务号可以填写appId</span>
        <span class="pl-s1"><span class="pl-pds">"</span>imgUrl<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>http://www.baidufe.com/fe/blog/static/img/weixin-qrcode-2.jpg<span class="pl-pds">'</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>link<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>http://www.baidufe.com<span class="pl-pds">'</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>desc<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>使用警告：此Api非官方版本，请各位尽量将分享功能迁移至腾讯官方版，会更稳定些！<span class="pl-pds">'</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">"</span>欢迎使用WeixinApi<span class="pl-pds">"</span></span>
    };

    <span class="pl-c">// 分享的回调</span>
    <span class="pl-s">var</span> wxCallbacks <span class="pl-k">=</span> {
        <span class="pl-c">// 收藏操作不执行回调，默认是开启(true)的</span>
        favorite <span class="pl-k">:</span> <span class="pl-c1">false</span>,

        <span class="pl-c">// 分享操作开始之前</span>
        <span class="pl-en">ready</span> : <span class="pl-st">function</span>() {
            <span class="pl-c">// 你可以在这里对分享的数据进行重组</span>
            <span class="pl-s3">alert</span>(<span class="pl-s1"><span class="pl-pds">"</span>准备分享<span class="pl-pds">"</span></span>);
        },
        <span class="pl-c">// 分享被用户自动取消</span>
        <span class="pl-en">cancel</span> : <span class="pl-st">function</span>(<span class="pl-vpf">resp</span>) {
            <span class="pl-c">// 你可以在你的页面上给用户一个小Tip，为什么要取消呢？</span>
            <span class="pl-s3">alert</span>(<span class="pl-s1"><span class="pl-pds">"</span>分享被取消，msg=<span class="pl-pds">"</span></span> <span class="pl-k">+</span> resp.err_msg);
        },
        <span class="pl-c">// 分享失败了</span>
        <span class="pl-en">fail</span> : <span class="pl-st">function</span>(<span class="pl-vpf">resp</span>) {
            <span class="pl-c">// 分享失败了，是不是可以告诉用户：不要紧，可能是网络问题，一会儿再试试？</span>
            <span class="pl-s3">alert</span>(<span class="pl-s1"><span class="pl-pds">"</span>分享失败，msg=<span class="pl-pds">"</span></span> <span class="pl-k">+</span> resp.err_msg);
        },
        <span class="pl-c">// 分享成功</span>
        <span class="pl-en">confirm</span> : <span class="pl-st">function</span>(<span class="pl-vpf">resp</span>) {
            <span class="pl-c">// 分享成功了，我们是不是可以做一些分享统计呢？</span>
            <span class="pl-s3">alert</span>(<span class="pl-s1"><span class="pl-pds">"</span>分享成功，msg=<span class="pl-pds">"</span></span> <span class="pl-k">+</span> resp.err_msg);
        },
        <span class="pl-c">// 整个分享过程结束</span>
        <span class="pl-en">all</span> : <span class="pl-st">function</span>(<span class="pl-vpf">resp</span>,<span class="pl-vpf">shareTo</span>) {
            <span class="pl-c">// 如果你做的是一个鼓励用户进行分享的产品，在这里是不是可以给用户一些反馈了？</span>
            <span class="pl-s3">alert</span>(<span class="pl-s1"><span class="pl-pds">"</span>分享<span class="pl-pds">"</span></span> <span class="pl-k">+</span> (shareTo <span class="pl-k">?</span> <span class="pl-s1"><span class="pl-pds">"</span>到<span class="pl-pds">"</span></span> <span class="pl-k">+</span> shareTo <span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>) <span class="pl-k">+</span> <span class="pl-s1"><span class="pl-pds">"</span>结束，msg=<span class="pl-pds">"</span></span> <span class="pl-k">+</span> resp.err_msg);
        }
    };

    <span class="pl-c">// 用户点开右上角popup菜单后，点击分享给好友，会执行下面这个代码</span>
    Api.shareToFriend(wxData, wxCallbacks);

    <span class="pl-c">// 点击分享到朋友圈，会执行下面这个代码</span>
    Api.shareToTimeline(wxData, wxCallbacks);

    <span class="pl-c">// 点击分享到腾讯微博，会执行下面这个代码</span>
    Api.shareToWeibo(wxData, wxCallbacks);

    <span class="pl-c">// iOS上，可以直接调用这个API进行分享，一句话搞定</span>
    Api.generalShare(wxData,wxCallbacks);
});</pre></div>

<p>可能有的朋友不知道appId从哪儿获取，请看这里：<a href="http://jingyan.baidu.com/article/6525d4b12af618ac7c2e9468.html">如何获取appId</a></p>

<p><strong>分享的数据可以动态修改：</strong></p>

<ul>
<li>普通模式分享：分享的数据是固定的，代码请参考 <a href="https://github.com/zxlie/WeixinApi/blob/master/sample/sample-normal.html">sample/sample-normal.html</a>
</li>
<li>异步模式分享：分享的数据是可以被动态修改的，代码请参考 <a href="https://github.com/zxlie/WeixinApi/blob/master/sample/sample-async.html">sample/sample-normal.html</a>
</li>
</ul>

<h3>
<a id="2隐藏右上角option-menu入口" class="anchor" href="#2%E9%9A%90%E8%97%8F%E5%8F%B3%E4%B8%8A%E8%A7%92option-menu%E5%85%A5%E5%8F%A3" aria-hidden="true"><span class="octicon octicon-link"></span></a>2、隐藏右上角option menu入口</h3>

<div class="highlight highlight-javascript"><pre>WeixinApi.ready(<span class="pl-st">function</span>(<span class="pl-vpf">Api</span>) {
    <span class="pl-c">// 隐藏</span>
    Api.hideOptionMenu();

    <span class="pl-c">// 显示</span>
    <span class="pl-c">// Api.showOptionMenu();</span>
});</pre></div>

<h3>
<a id="3隐藏底部工具栏" class="anchor" href="#3%E9%9A%90%E8%97%8F%E5%BA%95%E9%83%A8%E5%B7%A5%E5%85%B7%E6%A0%8F" aria-hidden="true"><span class="octicon octicon-link"></span></a>3、隐藏底部工具栏</h3>

<div class="highlight highlight-javascript"><pre>WeixinApi.ready(<span class="pl-st">function</span>(<span class="pl-vpf">Api</span>) {
    <span class="pl-c">// 隐藏</span>
    Api.hideToolbar();

    <span class="pl-c">// 显示</span>
    <span class="pl-c">// Api.showToolbar();</span>
});</pre></div>

<h3>
<a id="4获取当前的网络类型" class="anchor" href="#4%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9A%84%E7%BD%91%E7%BB%9C%E7%B1%BB%E5%9E%8B" aria-hidden="true"><span class="octicon octicon-link"></span></a>4、获取当前的网络类型</h3>

<div class="highlight highlight-javascript"><pre>WeixinApi.ready(<span class="pl-st">function</span>(<span class="pl-vpf">Api</span>) {
    Api.getNetworkType(<span class="pl-st">function</span>(<span class="pl-vpf">network</span>){
        <span class="pl-c">/**</span>
<span class="pl-c">         * network取值：</span>
<span class="pl-c">         *</span>
<span class="pl-c">         * network_type:wifi     wifi网络</span>
<span class="pl-c">         * network_type:edge     非wifi,包含3G/2G</span>
<span class="pl-c">         * network_type:fail     网络断开连接</span>
<span class="pl-c">         * network_type:wwan     2g或者3g</span>
<span class="pl-c">         */</span>
    });
});</pre></div>

<h3>
<a id="5调起客户端图片播放组件" class="anchor" href="#5%E8%B0%83%E8%B5%B7%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%9B%BE%E7%89%87%E6%92%AD%E6%94%BE%E7%BB%84%E4%BB%B6" aria-hidden="true"><span class="octicon octicon-link"></span></a>5、调起客户端图片播放组件</h3>

<div class="highlight highlight-javascript"><pre>WeixinApi.ready(<span class="pl-st">function</span>(<span class="pl-vpf">Api</span>) {
    <span class="pl-c">// 需要播放的图片src list</span>
    <span class="pl-s">var</span> srcList <span class="pl-k">=</span> [src1, src2, ..., srcN];
    <span class="pl-c">// 选一个作为当前需要展示的图片src</span>
    <span class="pl-s">var</span> curSrc <span class="pl-k">=</span> src1;
    <span class="pl-c">// 调起</span>
    Api.imagePreview(curSrc, srcList);
});</pre></div>

<p>调起客户端图片播放组件，还有一种更屌的方法，不需要依赖这个WeixinApi，直接a标签实现就行，具体格式：</p>

<pre><code>&lt;a href="weixin://viewimage/`YourImageURL`"&gt;AnyThing&lt;/a&gt;
</code></pre>

<p>我们可以用A标签来嵌套这个img，具体Demo如下：</p>

<div class="highlight highlight-html"><pre>&lt;<span class="pl-ent">a</span> <span class="pl-e">href</span>=<span class="pl-s1"><span class="pl-pds">"</span>weixin://viewimage/http://www.baidu.com/img/bdlogo.gif<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">img</span> <span class="pl-e">src</span>=<span class="pl-s1"><span class="pl-pds">"</span>http://www.baidu.com/img/bdlogo.gif<span class="pl-pds">"</span></span>&gt;
&lt;/<span class="pl-ent">a</span>&gt;
&lt;<span class="pl-ent">a</span> <span class="pl-e">href</span>=<span class="pl-s1"><span class="pl-pds">"</span>weixin://viewimage/http://tb2.bdstatic.com/tb/static-common/img/search_logo_big_6a13b553.gif<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">img</span> <span class="pl-e">src</span>=<span class="pl-s1"><span class="pl-pds">"</span>http://tb2.bdstatic.com/tb/static-common/img/search_logo_big_6a13b553.gif<span class="pl-pds">"</span></span>&gt;
&lt;/<span class="pl-ent">a</span>&gt;</pre></div>

<h3>
<a id="6关掉当前微信公众页面窗口" class="anchor" href="#6%E5%85%B3%E6%8E%89%E5%BD%93%E5%89%8D%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E9%A1%B5%E9%9D%A2%E7%AA%97%E5%8F%A3" aria-hidden="true"><span class="octicon octicon-link"></span></a>6、关掉当前微信公众页面窗口</h3>

<div class="highlight highlight-javascript"><pre>WeixinApi.ready(<span class="pl-st">function</span>(<span class="pl-vpf">Api</span>) { 
    <span class="pl-c">// 关闭窗口</span>
    WeixinApi.closeWindow({
        <span class="pl-en">success</span> : <span class="pl-st">function</span>(<span class="pl-vpf">resp</span>){
            <span class="pl-s3">alert</span>(<span class="pl-s1"><span class="pl-pds">'</span>关闭窗口成功！<span class="pl-pds">'</span></span>);
        },
        <span class="pl-en">fail</span> : <span class="pl-st">function</span>(<span class="pl-vpf">resp</span>){
            <span class="pl-s3">alert</span>(<span class="pl-s1"><span class="pl-pds">'</span>关闭窗口失败<span class="pl-pds">'</span></span>);
        }
    });
});</pre></div>

<h3>
<a id="7判断当前网页是否在微信内置浏览器中打开" class="anchor" href="#7%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E7%BD%91%E9%A1%B5%E6%98%AF%E5%90%A6%E5%9C%A8%E5%BE%AE%E4%BF%A1%E5%86%85%E7%BD%AE%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E6%89%93%E5%BC%80" aria-hidden="true"><span class="octicon octicon-link"></span></a>7、判断当前网页是否在微信内置浏览器中打开</h3>

<div class="highlight highlight-javascript"><pre>
    <span class="pl-c">// true or false</span>
    <span class="pl-s">var</span> flag <span class="pl-k">=</span> WeixinApi.openInWeixin();
</pre></div>

<h3>
<a id="8开启weixinapi的错误监控" class="anchor" href="#8%E5%BC%80%E5%90%AFweixinapi%E7%9A%84%E9%94%99%E8%AF%AF%E7%9B%91%E6%8E%A7" aria-hidden="true"><span class="octicon octicon-link"></span></a>8、开启WeixinApi的错误监控</h3>

<p>注意，这句代码务必放在WeixinApi.ready之前；上线的时候，根据实际需要，可删掉它</p>

<div class="highlight highlight-javascript"><pre><span class="pl-c">// 方法1：不带任何参数，将以alert方式提示出错信息</span>
WeixinApi.enableDebugMode();

<span class="pl-c">// 方法2：给一个callback，自己处理错误信息</span>
WeixinApi.enableDebugMode(<span class="pl-st">function</span>(<span class="pl-vpf">errObj</span>){
    <span class="pl-c">// errObj = {</span>
    <span class="pl-c">//     message : errorMessage,</span>
    <span class="pl-c">//     script : scriptURI,</span>
    <span class="pl-c">//     line : lineNumber,</span>
    <span class="pl-c">//     column : columnNumber</span>
    <span class="pl-c">// }</span>
});

<span class="pl-c">// 当然，你还可以做一件事：把这些错误信息上报到服务器</span></pre></div>

<h3>
<a id="9发送电子邮件" class="anchor" href="#9%E5%8F%91%E9%80%81%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6" aria-hidden="true"><span class="octicon octicon-link"></span></a>9、发送电子邮件</h3>

<div class="highlight highlight-javascript"><pre>WeixinApi.sendEmail({
    subject <span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>邮件标题<span class="pl-pds">'</span></span>,
    body <span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>邮件正文<span class="pl-pds">'</span></span>
},<span class="pl-st">function</span>(<span class="pl-vpf">resp</span>){
    <span class="pl-c">// 注意这里可不要轻易alert，会卡死的。。。</span>
});</pre></div>

<h3>
<a id="10禁止用户分享" class="anchor" href="#10%E7%A6%81%E6%AD%A2%E7%94%A8%E6%88%B7%E5%88%86%E4%BA%AB" aria-hidden="true"><span class="octicon octicon-link"></span></a>10、禁止用户分享</h3>

<div class="highlight highlight-javascript"><pre><span class="pl-c">// 先对Api进行初始化</span>
WeixinApi.ready(<span class="pl-st">function</span>(<span class="pl-vpf">Api</span>) {
    <span class="pl-c">// 禁止分享</span>
    Api.disabledShare(<span class="pl-st">function</span>(){
        <span class="pl-s3">alert</span>(<span class="pl-s1"><span class="pl-pds">'</span>当前页面禁止分享！<span class="pl-pds">'</span></span>);
    });
});</pre></div>

<p>代码请参考 <a href="https://github.com/zxlie/WeixinApi/blob/master/sample/sample-disable.html">sample/sample-normal.html</a></p>

<h2>
<a id="常见问题" class="anchor" href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98" aria-hidden="true"><span class="octicon octicon-link"></span></a>常见问题</h2>

<h3>
<a id="1用了这个api怎么没生效" class="anchor" href="#1%E7%94%A8%E4%BA%86%E8%BF%99%E4%B8%AAapi%E6%80%8E%E4%B9%88%E6%B2%A1%E7%94%9F%E6%95%88" aria-hidden="true"><span class="octicon octicon-link"></span></a>1、用了这个API怎么没生效</h3>

<p>如果遇到这种情况，请先回到这里，扫描最上面的 <a href="#user-content-api%E8%83%BD%E5%AE%9E%E7%8E%B0%E4%BB%80%E4%B9%88">二维码</a> Demo，首先验证Demo是否能运行正确；然后再参照demo.html调整自己的代码：</p>

<ul>
<li>1）、<code>WeixinApi.js</code>路径是否引用正确</li>
<li>2）、<code>WeixinApi.ready</code>是否正确执行了？（可以在里面加一个alert，简单粗暴可依赖）</li>
<li>3）、开启<code>WeixinApi.enableDebugMode</code>方便问题定位</li>
</ul>

<h3>
<a id="2android上取消分享依然提示成功" class="anchor" href="#2android%E4%B8%8A%E5%8F%96%E6%B6%88%E5%88%86%E4%BA%AB%E4%BE%9D%E7%84%B6%E6%8F%90%E7%A4%BA%E6%88%90%E5%8A%9F" aria-hidden="true"><span class="octicon octicon-link"></span></a>2、Android上取消分享依然提示成功</h3>

<p>传送门：<a href="http://www.baidufe.com/item/4bdcde11a024c63df3af.html">为什么分享到朋友圈，取消了依然提示成功？</a></p>

<h3>
<a id="3想自己做一个按钮直接分享" class="anchor" href="#3%E6%83%B3%E8%87%AA%E5%B7%B1%E5%81%9A%E4%B8%80%E4%B8%AA%E6%8C%89%E9%92%AE%E7%9B%B4%E6%8E%A5%E5%88%86%E4%BA%AB" aria-hidden="true"><span class="octicon octicon-link"></span></a>3、想自己做一个按钮直接分享</h3>

<p>就我目前了解到的情况来看，是行不通的，官方都有做权限控制，感兴趣可以到这里<a href="http://www.baidufe.com/item/f07a3be0b23b4c9606bb.html#content">去翻一下评论</a></p>

<h3>
<a id="4怎样动态修改分享的信息wxdata" class="anchor" href="#4%E6%80%8E%E6%A0%B7%E5%8A%A8%E6%80%81%E4%BF%AE%E6%94%B9%E5%88%86%E4%BA%AB%E7%9A%84%E4%BF%A1%E6%81%AFwxdata" aria-hidden="true"><span class="octicon octicon-link"></span></a>4、怎样动态修改分享的信息：wxData</h3>

<p>用到Api提供的<code>async:true</code>配置，具体可阅读<a href="http://www.baidufe.com/item/f07a3be0b23b4c9606bb.html">这里的使用介绍</a></p>

<h3>
<a id="5收藏的时候为什么也执行分享的回调了" class="anchor" href="#5%E6%94%B6%E8%97%8F%E7%9A%84%E6%97%B6%E5%80%99%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B9%9F%E6%89%A7%E8%A1%8C%E5%88%86%E4%BA%AB%E7%9A%84%E5%9B%9E%E8%B0%83%E4%BA%86" aria-hidden="true"><span class="octicon octicon-link"></span></a>5、收藏的时候为什么也执行分享的回调了？</h3>

<p>请在wxCallbacks中设置<code>favorite:false</code>，关闭收藏操作的callback</p>

<h2>
<a id="其他" class="anchor" href="#%E5%85%B6%E4%BB%96" aria-hidden="true"><span class="octicon octicon-link"></span></a>其他</h2>

<h3>
<a id="1更多互动" class="anchor" href="#1%E6%9B%B4%E5%A4%9A%E4%BA%92%E5%8A%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>1、更多互动</h3>

<p>详细的使用场景，还可以到这里获取：<a href="http://www.baidufe.com/item/f07a3be0b23b4c9606bb.html">http://www.baidufe.com/item/f07a3be0b23b4c9606bb.html</a></p>

<p>注意：这只是发烧版本，非微信官方出品！有问题可大家一起来讨论，我很乐意与大家一起来完善这个API。</p>

<h3>
<a id="2招聘广告" class="anchor" href="#2%E6%8B%9B%E8%81%98%E5%B9%BF%E5%91%8A" aria-hidden="true"><span class="octicon octicon-link"></span></a>2、招聘广告</h3>

<p>鄙人目前在美丽说商业产品前端团队，队里缺靠谱的FE，欢迎推荐或自荐：<a href="http://www.baidufe.com/item/25ea3376a893619eea8c.html">http://www.baidufe.com/item/25ea3376a893619eea8c.html</a></p>

<h3>
<a id="3如果你觉得这个api对你有用" class="anchor" href="#3%E5%A6%82%E6%9E%9C%E4%BD%A0%E8%A7%89%E5%BE%97%E8%BF%99%E4%B8%AAapi%E5%AF%B9%E4%BD%A0%E6%9C%89%E7%94%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>3、如果你觉得这个Api对你有用：</h3>

<p><img src="http://www.baidufe.com/upload/images/2014-11-03_21-19-40_5.png" alt="alien-alipay-qrcode-256.png"></p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Weixinapi maintained by <a href="https://github.com/itime">itime</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
